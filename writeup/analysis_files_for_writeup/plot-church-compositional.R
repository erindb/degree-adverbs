library(ggplot2)
source("~/opt/r_helper_scripts/gg_themes.R")

toplot = function(utt, dist, vals) {
  values = c(0, 1, 0.25, 0.5, 0.75)
  return(data.frame(
    values = values,
    utterance=rep(utt, length(values)),
    prior=rep(dist,  length(values)),
    weights = as.numeric(unlist(strsplit(vals, " ")))))
}

#where "very > bare" is hardcoded
# distributions = rbind(
#   #"peaked mid is gaussian w/ mean 0.5 sd 0.2"
#     toplot("prior", "peaked-mid", "0.009870647465794937 0.009870647465794937 0.19437203427500685 0.5915146365183964 0.19437203427500685"),
#     toplot("no utterance (cost=0)", "peaked-mid", "0.00899135892783637 0.00899135892783637 0.18617353647974985 0.6096702091848276 0.18617353647974985"),
#     toplot("tall (cost=1)", "peaked-mid", "0.002256305036823323 0.05081542668579683 0.09000545902893428 0.4295010827017602 0.4274217265466855"),
#     toplot("short (cost=1)", "peaked-mid", "0.050815426685796826 0.0022563050368233227 0.42742172654668537 0.42950108270176013 0.09000545902893427"),
#     toplot("very tall (cost=2)", "peaked-mid", "0.0008793593626715402 0.10391829782032919 0.04204532542061588 0.2547310992736995 0.5984259181226838"),
#     toplot("very short (cost=2)", "peaked-mid", "0.1039182978203292 0.0008793593626715402 0.5984259181226839 0.2547310992736995 0.042045325420615884"),
#     toplot("extremely tall (cost=10)", "peaked-mid", "0.000007919842669685217 0.9778770451932529 0.0004405149740975846 0.0027980666717241395 0.0188764533182557"),
#     toplot("extremely short (cost=10)", "peaked-mid", "0.9778770451932529 0.000007919842669685217 0.0188764533182557 0.0027980666717241395 0.0004405149740975846"),
#     # peaked both is just a line that goes down the midpoint then back up
#     toplot("prior", "peaked-both", "0.27272727 0.27272727 0.18181818 0.09090909 0.18181818"),
#     toplot("no utterance (cost=0)", "peaked-both", "0.26023682350940863 0.26023682350940863 0.19098117667191325 0.09756399963735635 0.19098117667191325"),
#     toplot("tall (cost=1)", "peaked-both", "0.049675830485446514 0.5199578302802841 0.09456933887510241 0.08408382631622702 0.2517131740429399"),
#     toplot("short (cost=1)", "peaked-both", "0.5199578302802841 0.049675830485446514 0.2517131740429399 0.08408382631622702 0.09456933887510241"),
#     toplot("very tall (cost=2)", "peaked-both", "0.0202708270275209 0.5741980137359832 0.06467387698954781 0.07919617023175599 0.26166111201519215"),
#     toplot("very short (cost=2)", "peaked-both", "0.5741980137359831 0.020270827027520897 0.2616611120151921 0.07919617023175597 0.0646738769895478"),
#     toplot("extremely tall (cost=10)", "peaked-both", "0.020771044570361122 0.5710497746137095 0.06681983607196984 0.07991913601687639 0.26144020872708307"),
#     toplot("extremely short (cost=10)", "peaked-both", "0.5710497746137095 0.020771044570361125 0.26144020872708307 0.07991913601687639 0.06681983607196983")
# #   toplot("prior", "peaked", "")#,
# #   toplot("no utterance (cost=0)", "peaked", ""),
# #   toplot("rain (cost=0.1)", "peaked", ""),
# #   toplot("not-rain (cost=0.1)", "peaked", ""),
# #   toplot("must (cost=100)", "peaked", ""),
# #   toplot("must-not (cost=100)", "peaked", "")
# )

distributions = rbind(
  #"peaked mid is gaussian w/ mean 0.5 sd 0.2"
  toplot("prior", "peaked-mid", "0.009870647465794937 0.009870647465794937 0.19437203427500685 0.5915146365183964 0.19437203427500685"),
  toplot("no utterance (cost=0)", "peaked-mid", "0.009828327797963965 0.009828327797963965 0.19544268332301556 0.5894579777580409 0.19544268332301556"),
  toplot("tall (cost=1)", "peaked-mid", "0.0009736333828371074 0.06851273734365262 0.05907914194833604 0.37864016223287084 0.4927943250923034"),
  toplot("short (cost=1)", "peaked-mid", "0.06851273734365262 0.0009736333828371074 0.4927943250923034 0.37864016223287084 0.05907914194833605"),
  toplot("very tall (cost=2)", "peaked-mid", "0.0007111713589281494 0.09007550266534171 0.04452931183419864 0.2777249729765566 0.5869590411649749"),
  toplot("very short (cost=2)", "peaked-mid", "0.09007550266534173 0.0007111713589281494 0.5869590411649749 0.2777249729765567 0.04452931183419865"),
  toplot("extremely tall (cost=10)", "peaked-mid", "0.000007616827724329322 0.9738091764527186 0.0005201434244804059 0.00307933926920359 0.022583724025873053"),
  toplot("extremely short (cost=10)", "peaked-mid", "0.9738091764527186 0.000007616827724329322 0.022583724025873053 0.00307933926920359 0.0005201434244804059")#,
  # peaked both is just a line that goes down the midpoint then back up
#   toplot("prior", "peaked-both", "0.27272727 0.27272727 0.18181818 0.09090909 0.18181818"),
#   toplot("no utterance (cost=0)", "peaked-both", "0.2590283022297041 0.2590283022297041 0.19204661354076952 0.0978501684590527 0.19204661354076952"),
#   toplot("tall (cost=1)", "peaked-both", "0.021344688345147113 0.569824945297623 0.06621105693970104 0.07925583248353894 0.2633634769339898"),
#   toplot("short (cost=1)", "peaked-both", "0.569824945297623 0.021344688345147113 0.2633634769339898 0.07925583248353894 0.06621105693970103"),
#   toplot("very tall (cost=2)", "peaked-both", "0.02263559971828721 0.561913897511387 0.07112635727147881 0.08118602326782452 0.2631381222310225"),
#   toplot("very short (cost=2)", "peaked-both", "0.561913897511387 0.02263559971828721 0.2631381222310225 0.08118602326782452 0.07112635727147881"),
#   toplot("extremely tall (cost=10)", "peaked-both", "0.02370531940453914 0.5566282453521497 0.07443605576161749 0.08244823684556254 0.26278214263613103"),
#   toplot("extremely short (cost=10)", "peaked-both", "0.5566282453521498 0.023705319404539144 0.26278214263613103 0.08244823684556256 0.0744360557616175")
)

distributions$utterance = factor(distributions$utterance)
p = ggplot(distributions, aes(x=values, y=weights)) +
  geom_line(stat="identity", aes(colour=utterance)) +
  #facet_wrap(~ prior) +
  ylab("") +
  scale_colour_manual(values=c("white", "yellow", "cyan", "deeppink", "turquoise4", "magenta", "chartreuse4", "purple")) +
#   ggtitle("") +
  xlab("heights") +
  theme_bw(22) +
  theme(panel.grid=element_blank())
print(p)
ggsave("model_results.png", width=10, height=6)
