# Intensity of degree adverbs

Hypothesis: adverbs of degree, like "somewhat" and "extremely", modify the adjectives they describe in proportion to the cost of uttering them. For example, if "inordinately" is more costly to utter than "very", the former will have a stronger meaning than the latter.

This cost might manifest in syllable length or in surprisal (how unlikely is that word to be said?).

## Experiment 1: intensifiers

```{r }

#data from experiment on september 05 2013
intensifiers = read.table("intensifiers.tsv", header=T, sep="\t")
intensifiers = subset(intensifiers, workerid < 40) #later workers are for later experiments

intensifiers$workerid = as.factor(intensifiers$workerid)
intensifiers = intensifiers[,c("price", "intensifier", "item", "workerid")]

#z-score by participant
library(plyr)
intensifiers$zprice = ddply(intensifiers, .(workerid), summarize, zprice=scale(price))$zprice

#don't include "[no intensifier] expensive" in the analysis, but do use it to zscore.
intensifiers = intensifiers[intensifiers$intensifier != "",]

## ngrams
ngrams = read.table("ngrams.sep", header=T, sep="\t")
frequency = ngrams$frequency
names(frequency) = ngrams$ngram
syllables = ngrams$syllables
names(syllables) = ngrams$ngram
total_1grams = 1024908267229
intensifiers$frequency = sapply(as.character(intensifiers$intensifier), function(adverb) {
  frequency[[adverb]]
})
intensifiers$probability = intensifiers$frequency / total_1grams
intensifiers$surprisal = - log(intensifiers$probability)
intensifiers$syllables = sapply(as.character(intensifiers$intensifier), function(adverb) {
  if (adverb == "") {
    return(0)
  } else {
    return(syllables[[adverb]])
  }
})

human_watch_priors = read.table("pricePriors_humans/watch.txt")$V1
human_laptop_priors = read.table("pricePriors_humans/laptop.txt")$V1
human_coffeemaker_priors = read.table("pricePriors_humans/coffee_maker.txt")$V1

sds = c("watch"=sd(human_watch_priors), "laptop"=sd(human_laptop_priors), "coffee maker"=sd(human_coffeemaker_priors))
means = c("watch"=mean(human_watch_priors), "laptop"=mean(human_laptop_priors), "coffee maker"=mean(human_coffeemaker_priors))

intensifiers$itemsd = sapply(as.character(intensifiers$item), function(item) {sds[[item]]})
intensifiers$itemmean = sapply(as.character(intensifiers$item), function(item) {means[[item]]})
intensifiers$sdprice = (intensifiers$price - intensifiers$itemmean) / intensifiers$itemsd
intensifiers$sdzprice =  ddply(intensifiers, .(workerid), summarize, sdzprice=scale(sdprice))$sdzprice
```

In Experiment 1, I check whether there is any relationship between cost and strength of an intensifying degree adverb.

I use Google Ngrams data to get the surprisal of various intensifying degree adverbs and recorded their syllable lengths.

```{r }
print(ngrams)
```

For the set of degree adverbs I studied, the correlation between my two possible measure of cost, surprisal and syllable length, is `r with(intensifiers, cor(surprisal, syllables))`.

I ran an experiment asking participants the prices of different "*[adverb]* expensive" watches, laptops, and coffee makers. Prices were elicited with free response, and trials looked like this:

![items-in-friends-purchases.png](items-in-friends-purchases.png)

In a simple ANOVA, participant (`workerid`) was the best predictor of response.

```{r }
fit = lm(price ~ intensifier * item * workerid, data=intensifiers)
print(anova(fit))
```

If I z-score the data by participants and run an ANOVA on that, 

```{r fig.width=10, fig.height=4.5, }
zfit = lm(zprice ~ intensifier * item * workerid, data=intensifiers)
print(anova(zfit))
library(ggplot2)
source("~/opt/r_helper_scripts/bootsSummary.r")
intensifiers_summary = bootsSummary(data=intensifiers, measurevar="zprice", groupvars=c("item", "intensifier", "syllables", "surprisal"))
p = ggplot(intensifiers_summary, aes(x=surprisal, y=zprice, colour=syllables)) +
  geom_point() +
  geom_smooth(method="lm", se=T, colour="black") +
  geom_errorbar(aes(ymin=bootsci_low, ymax=bootsci_high, x=surprisal)) +
  facet_wrap(~ item)
print(p)
```

If I rescale items based on means and variances from a separate experiment that Justine ran...

```{r }

```

In a mixed effects model, I find a nonsignificant positive effect of surprisal on response.

```{r }
library(lme4)
fit = lmer(data=intensifiers, price~(surprisal) + (1 | item) + (1 | workerid) + (surprisal | workerid) + (surprisal | item))
print(summary(fit))
fit = lmer(data=intensifiers, price~(surprisal) + (1 | item) + (1 | workerid) + (surprisal | item))
print(summary(fit))
fit = lmer(data=intensifiers, price~(syllables) + (1 | item) + (1 | workerid) + (syllables | workerid) + (syllables | item))
print(summary(fit))
fit = lmer(data=intensifiers, price~(surprisal + syllables) + (1 | item) + (1 | workerid) + (surprisal + syllables | item))
print(summary(fit))
# fit = lmer(data=intensifiers, zprice~(surprisal) + (1 | item) + (surprisal | item))
# print(summary(fit))
```

I found that different participants (denoted by the variable `workerid`) gave very different kinds of prices, so in my analysis, I z-scored all responses. Because every pariticpant saw every combination of intensifier and item, this will standardize participants' responses.

```{r }
fit = lm(price ~ intensifier * item * workerid, data=intensifiers)
print(anova(fit))
library(plyr)
intensifiers$zprice = ddply(intensifiers, .(workerid), summarize, zprice=scale(price))$zprice
fit = lm(zprice ~ intensifier * item * workerid, data=intensifiers)
print(anova(fit))
```

```{r }
# intensifiers = read.table("intensifiers.tsv", header=T, sep="\t")
# intensifiers = subset(intensifiers, workerid < 40) #later workers are for later experiments
# intensifiers$workerid = as.factor(intensifiers$workerid)
# intensifiers = intensifiers[,c("price", "intensifier", "item", "workerid")]
# fit = lm(price ~ intensifier * item * workerid, data=intensifiers)
# print(anova(fit))
# library(plyr)
# intensifiers$zprice = ddply(intensifiers, .(workerid), summarize, zprice=scale(price))$zprice
# fit = lm(zprice ~ intensifier * item * workerid, data=intensifiers)
# print(anova(fit))
# ## ngrams
# ngrams = read.table("ngrams.sep", header=T, sep="\t")
# frequency = ngrams$frequency
# names(frequency) = ngrams$ngram
# syllables = ngrams$syllables
# names(syllables) = ngrams$ngram
# total_1grams = 1024908267229
# intensifiers$surprisal = sapply(as.character(intensifiers$intensifier), function(adverb) {
#   if (adverb == "") {
#     return(0)
#   } else{
#     return( - (log(frequency[[adverb]]) - log(total_1grams)))
#   }
# })
# intensifiers$syllables = sapply(as.character(intensifiers$intensifier), function(adverb) {
#   if (adverb == "") {
#     return(0)
#   } else {
#     return(syllables[[adverb]])
#   }
# })

#lmer(thatrt~cond_prob + (cond_prob | subject) + (1 | item), data=the_that)

library(lme4)
library(lmerTest)
fit = lmer(data=intensifiers, price~(surprisal) + (1 | item) + (1 | workerid) + (surprisal | workerid) + (surprisal | item))
print(summary(fit))
```

Z-scored prices seem to depend on the item (naturally some items are more expensive than others) and on surprisal (more surprising degree adverbs tend to have stronger meanings). There appears to be an interaction between surprisal and number of syllables, as well.

```{r fig.width=10, fig.height=4.5, }

library(ggplot2)
source("~/opt/r_helper_scripts/bootsSummary.r")
intensifiers_summary = bootsSummary(data=intensifiers, measurevar="zprice", groupvars=c("item", "intensifier", "syllables", "surprisal"))
p = ggplot(intensifiers_summary, aes(x=surprisal, y=zprice, colour=syllables)) +
  geom_point() +
  geom_smooth(method="lm", se=T, colour="black") +
  geom_errorbar(aes(ymin=bootsci_low, ymax=bootsci_high, x=surprisal)) +
  facet_wrap(~ item)
print(p)

fit = lm(zprice ~ surprisal * syllables * item, data=intensifiers)
print(anova(fit))
print(fit)
```

There is an interaction between the effect of surprisal and the item, so I tried z-scoring within items as well as within workers (variable `zzprice`), which mostly washes out the correlation betweens surprisal and strength of degree adverb. Possibly this is because we are losing information about how participants use the scale when we only look at their behavior on one item at a time.

```{r fig.width=10, fig.height=4.5, }
intensifiers$zzprice = ddply(intensifiers, .(workerid, item), summarize, zzprice=scale(price))$zzprice
intensifiers = intensifiers[!is.na(intensifiers$zzprice),]
intensifiers_summary = bootsSummary(data=intensifiers, measurevar="zzprice", groupvars=c("item", "intensifier", "syllables", "surprisal"), na.rm=T)
p = ggplot(intensifiers_summary, aes(x=surprisal, y=zzprice, colour=syllables)) +
  geom_point() +
  geom_smooth(method="lm", se=T, colour="black") +
  geom_errorbar(aes(ymin=bootsci_low, ymax=bootsci_high, x=surprisal)) +
  facet_wrap(~ item)
print(p)
fit = lm(zzprice ~ surprisal * syllables * item, data=intensifiers)
print(anova(fit))
print(fit)
```

Overall, in Experiment 1 I found some evidence that degree adverbs that are less probable in a corpus tend to have stronger meanings. If there really is such a correlation, it is unclear whether the surprisal of the word causes the meaning. Possibly events that are more extreme are less common in the world and therefore are talked about less (this seems somewhat unlikely given that people are more likely to comment on unusual events than to comment on ordinary events, but it is possible). If this were the case, then we would find a correlation between surprisal and strength of degree adverbs, but this would not give us much information about how the meanings of those degree adverbs come to be. In order to resolve this confound, I ran Experiment 2.

## Experiment 2

In Experiment 2, I used degree adverbs that modified adjectives in the opposite direction from the intensifiers of Experiment 1. I used "deintensifying" degree adverbs like "somwhat" and "moderately", which have stronger meanings when they describe more ordinary objects. For example, a "somewhat expensive watch" would have a more ordinary price than an "expensive watch".

If more ordinary objects are talked about more, and this is what drives the correlation between surprisal and degree in Experiment 1, then less strong deintensifiers (those that correspond to higher prices) should be less common in a corpus and therefore have higher surprisal values.

However, if the strength of a degree adverb is greater as a result of it being less commonly used, then stronger deintensifiers (those that correspond to lower prices) should be less common in a corpus.

Using prices z-scored by participant, I found a negative relationship between surprisal (I'm using negative log frequency instead of negative log probability here because I don't have access to the total number of 2-grams and some of my deintensifiers were 2-grams) and responses. This provides evidence for the hypothesis that the improbability of a degree adverb might be the source of its strength.

```{r , fig.width=10, fig.height=4.5}

#data from experiment on january 08 2014
deintensifiers = read.table("intensifiers.tsv", header=T, sep="\t")
deintensifiers = subset(deintensifiers, workerid >= 40) #later workers are for later experiments
deintensifiers$workerid = as.factor(deintensifiers$workerid)
deintensifiers = deintensifiers[,c("price", "intensifier", "item", "workerid")]
deintensifiers$zprice = ddply(deintensifiers, .(workerid), summarize, zprice=scale(price))$zprice
deintensifiers$zzprice = ddply(deintensifiers, .(workerid, item), summarize, zzprice=scale(price))$zzprice
deintensifiers = deintensifiers[!is.na(deintensifiers$zzprice),]

## ngrams
ngrams = read.table("ngrams.sep", header=T, sep="\t")
frequency = ngrams$frequency
names(frequency) = ngrams$ngram
syllables = ngrams$syllables
names(syllables) = ngrams$ngram
deintensifiers$surprisal = sapply(as.character(deintensifiers$intensifier), function(adverb) {
  if (adverb == "") {
    return(0)
  } else{
    return( - (log(frequency[[adverb]])))
  }
})
deintensifiers$syllables = sapply(as.character(deintensifiers$intensifier), function(adverb) {
  if (adverb == "") {
    return(0)
  } else {
    return(syllables[[adverb]])
  }
})

deintensifiers_summary = bootsSummary(data=deintensifiers, measurevar="zprice", groupvars=c("item", "intensifier", "syllables", "surprisal"))
p = ggplot(deintensifiers_summary, aes(x=surprisal, y=zprice, colour=syllables)) +
  geom_point() +
  geom_smooth(method="lm", se=T, colour="black") +
  geom_errorbar(aes(ymin=bootsci_low, ymax=bootsci_high, x=surprisal)) +
  facet_wrap(~ item)
print(p)

fit = lm(zprice ~ surprisal * syllables * item, data=deintensifiers)
print(anova(fit))
print(fit)
```

Again, I do not find this effect when I z-score by both participant and item.

```{r , fig.width=10, fig.height=4.5}
deintensifiers_summary = bootsSummary(data=deintensifiers, measurevar="zzprice", groupvars=c("item", "intensifier", "syllables", "surprisal"))
p = ggplot(deintensifiers_summary, aes(x=surprisal, y=zzprice, colour=syllables)) +
  geom_point() +
  geom_smooth(method="lm", se=T, colour="black") +
  geom_errorbar(aes(ymin=bootsci_low, ymax=bootsci_high, x=surprisal)) +
  facet_wrap(~ item)
print(p)

fit = lm(zzprice ~ surprisal * syllables * item, data=deintensifiers)
print(anova(fit))
print(fit)
```

# Experiment 3

In Experiment 3, I replicated my findings from Experiments 1 and 2 on a new set of degree adverbs.

With responses z-scored by participant, I find a positive relationship between surprisal and response for intensifiers.

```{r , fig.width=10, fig.height=4.5}
degree_adverbs = read.table("../exp2-analysis/degree-adverbs.tsv", header=T, sep="\t")
degree_adverbs$workerid = as.factor(degree_adverbs$workerid)
degree_adverbs = degree_adverbs[,c("price", "word", "item", "workerid")]
degree_adverbs$zprice = ddply(degree_adverbs, .(workerid), summarize, zprice=scale(price))$zprice
degree_adverbs$zzprice = ddply(degree_adverbs, .(workerid, item), summarize, zzprice=scale(price))$zzprice
degree_adverbs = degree_adverbs[!is.na(degree_adverbs$zzprice),]

## ngrams
ngrams = read.table("ngrams2.sep", header=T, sep="\t")
frequency = ngrams$frequency
names(frequency) = ngrams$ngram
syllables = ngrams$syllables
names(syllables) = ngrams$ngram
degree_adverbs$surprisal = sapply(as.character(degree_adverbs$word), function(adverb) {
  if (adverb == "") {
    return(0)
  } else{
    return( - (log(frequency[[adverb]])))
  }
})
degree_adverbs$syllables = sapply(as.character(degree_adverbs$word), function(adverb) {
  if (adverb == "") {
    return(0)
  } else {
    return(syllables[[adverb]])
  }
})

intensifiers = degree_adverbs[degree_adverbs$word %in% c("horribly","super", "uber", "totally", "radically",
                                                         "decidedly", "ridiculously", "pretty", "phenomenally",
                                                         "crazily", "terribly", "stupidly", "vastly", "intensely",
                                                         "greatly", "highly", "extraordinarily", "really",
                                                         "outrageously", "excessively", "astoundingly", "very",
                                                         "extremely", "supremely", "real", "wildly",
                                                         "fantastically", "truly", "amazingly", "enormously",
                                                         "crazy", "rather", "uncommonly", "exceedingly", "insanely",
                                                         "quite", "hugely", "ever so"),]
deintensifiers = degree_adverbs[degree_adverbs$word %in% c("relatively", "somewhat", "moderately", "barely",
                                                           "fairly", "sorta", "slightly", "kinda", "reasonably",
                                                           "a tad", "sort of", "a bit", "kind of", "a little"),]
simple_adjective = degree_adverbs[degree_adverbs$word == "",]

# degree_adverbs_summary = bootsSummary(data=degree_adverbs, measurevar="zprice", groupvars=c("item", "word", "syllables", "surprisal"))
# p = ggplot(degree_adverbs_summary, aes(x=surprisal, y=zprice, colour=syllables)) +
#   geom_point() +
#   geom_smooth(method="lm", se=T, colour="black") +
#   geom_errorbar(aes(ymin=bootsci_low, ymax=bootsci_high, x=surprisal)) +
#   facet_wrap(~ item)
# print(p)

intensifiers_summary = bootsSummary(data=intensifiers, measurevar="zprice", groupvars=c("item", "word", "syllables", "surprisal"))
p = ggplot(intensifiers_summary, aes(x=surprisal, y=zprice, colour=syllables)) +
  geom_point() +
  geom_smooth(method="lm", se=T, colour="black") +
  geom_errorbar(aes(ymin=bootsci_low, ymax=bootsci_high, x=surprisal)) +
  facet_wrap(~ item)
print(p)

fit = lm(zprice ~ surprisal * syllables * item, data=intensifiers)
print(anova(fit))
print(fit)
```

Although I find a negative relationship between surprisal and response for deintensifiers, this relationship is nonsignificant.

```{r , fig.width=10, fig.height=4.5}
deintensifiers_summary = bootsSummary(data=deintensifiers, measurevar="zprice", groupvars=c("item", "word", "syllables", "surprisal"))
p = ggplot(deintensifiers_summary, aes(x=surprisal, y=zprice, colour=syllables)) +
  geom_point() +
  geom_smooth(method="lm", se=T, colour="black") +
  geom_errorbar(aes(ymin=bootsci_low, ymax=bootsci_high, x=surprisal)) +
  facet_wrap(~ item)
print(p)

fit = lm(zprice ~ surprisal * syllables * item, data=deintensifiers)
print(anova(fit))
print(fit)
```

As in Experiments 1 and 2, I do not find significant relationships between surprisal and response when I z-score by both participant and item.

```{r , fig.width=10, fig.height=4.5 }
intensifiers_summary = bootsSummary(data=intensifiers, measurevar="zzprice", groupvars=c("item", "word", "syllables", "surprisal"))
p = ggplot(intensifiers_summary, aes(x=surprisal, y=zzprice, colour=syllables)) +
  geom_point() +
  geom_smooth(method="lm", se=T, colour="black") +
  geom_errorbar(aes(ymin=bootsci_low, ymax=bootsci_high, x=surprisal)) +
  facet_wrap(~ item)
print(p)

fit = lm(zzprice ~ surprisal * syllables * item, data=intensifiers)
print(anova(fit))
print(fit)

deintensifiers_summary = bootsSummary(data=deintensifiers, measurevar="zzprice", groupvars=c("item", "word", "syllables", "surprisal"))
p = ggplot(deintensifiers_summary, aes(x=surprisal, y=zzprice, colour=syllables)) +
  geom_point() +
  geom_smooth(method="lm", se=T, colour="black") +
  geom_errorbar(aes(ymin=bootsci_low, ymax=bootsci_high, x=surprisal)) +
  facet_wrap(~ item)
print(p)

fit = lm(zzprice ~ surprisal * syllables * item, data=deintensifiers)
print(anova(fit))
print(fit)
```




```{r fig.width=10, fig.height=4.5, }
zfit = lm(zprice ~ intensifier * item * workerid, data=intensifiers)
print(anova(zfit))
library(ggplot2)
source("~/opt/r_helper_scripts/bootsSummary.r")
intensifiers_summary = bootsSummary(data=intensifiers, measurevar="zprice", groupvars=c("item", "intensifier", "syllables", "surprisal"))
p = ggplot(intensifiers_summary, aes(x=surprisal, y=zprice, colour=syllables)) +
  geom_point() +
  geom_smooth(method="lm", se=T, colour="black") +
  geom_errorbar(aes(ymin=bootsci_low, ymax=bootsci_high, x=surprisal)) +
  facet_wrap(~ item)
print(p)
```

...

```{r fig.width=10, fig.height=4.5, }
zfit = lm(zprice ~ surprisal * itemmean * itemsd, data=intensifiers)
print(anova(zfit))
library(ggplot2)
source("~/opt/r_helper_scripts/bootsSummary.r")
intensifiers_summary = bootsSummary(data=intensifiers, measurevar="zprice", groupvars=c("item", "intensifier", "syllables", "surprisal"))
p = ggplot(intensifiers_summary, aes(x=surprisal, y=zprice, colour=syllables)) +
  geom_point() +
  geom_smooth(method="lm", se=T, colour="black") +
  geom_errorbar(aes(ymin=bootsci_low, ymax=bootsci_high, x=surprisal)) +
  facet_wrap(~ item)
print(p)
```


